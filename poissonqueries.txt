ALTER TABLE allmatches ADD COLUMN GP REAL;
ALTER TABLE allmatches ADD COLUMN T_HG REAL;
UPDATE leagues set GP=(SELECT COUNT(*) FROM allmatches WHERE division=leagues.d_vision);
UPDATE allmatches SET GP=(SELECT GP FROM leagues WHERE d_vision=allmatches.division);
UPDATE leagues SET T_HG=(SELECT SUM(FTHG) FROM allmatches WHERE division=leagues.d_vision);
UPDATE allmatches SET T_HG=(SELECT T_HG FROM leagues WHERE d_vision=allmatches.division);
ALTER TABLE allmatches ADD COLUMN avg_HG DECIMAL(10,5);/* GP and T_HG need to start*/
UPDATE allmatches SET avg_HG= T_HG/GP;
ALTER TABLE allmatches ADD COLUMN T_AG REAL;
UPDATE leagues SET T_AG=(SELECT SUM(FTAG) FROM allmatches WHERE division=leagues.d_vision);
UPDATE allmatches SET T_AG=(SELECT T_AG FROM leagues WHERE d_vision=allmatches.division);
ALTER TABLE allmatches ADD COLUMN avg_AG DECIMAL(10,5);
UPDATE allmatches SET avg_AG= T_AG/GP; 
ALTER TABLE allmatches ADD COLUMN team_HG REAL;
ALTER TABLE allmatches ADD COLUMN team_homeGP REAL;
ALTER TABLE allmatches ADD COLUMN team_AG REAL;
ALTER TABLE allmatches ADD COLUMN team_awayGP REAL;
UPDATE teams SET team_HG=(SELECT SUM(FTHG) FROM allmatches WHERE HomeTeam=teams.team);
UPDATE teams SET team_homeGP=(SELECT COUNT(*) FROM allmatches WHERE HomeTeam=teams.team);
UPDATE teams SET team_AG=(SELECT SUM(FTAG) FROM allmatches WHERE AwayTeam=teams.team);
UPDATE teams SET team_awayGP=(SELECT COUNT(*) FROM allmatches WHERE AwayTeam=teams.team);
UPDATE allmatches SET team_HG=(SELECT team_HG FROM teams WHERE team =allmatches.HomeTeam);
UPDATE allmatches SET team_homeGP=(SELECT team_homeGP FROM teams WHERE team=allmatches.HomeTeam);
UPDATE allmatches SET team_AG=(SELECT team_AG FROM teams WHERE team=allmatches.AwayTeam);
UPDATE allmatches SET team_awayGP=(SELECT team_awayGP FROM teams WHERE team=allmatches.AwayTeam);
ALTER TABLE  allmatches ADD COLUMN home_as DECIMAL(10,5);
ALTER TABLE  allmatches ADD COLUMN Away_as DECIMAL(10,5);
UPDATE allmatches SET home_as = round(((team_HG/team_homeGP)/avg_HG),2);
UPDATE allmatches SET away_as = round(((team_AG/team_awayGP)/avg_HG),2);
ALTER TABLE allmatches add COLUMN team_HC REAL;
ALTER TABLE allmatches add  COLUMN team_AC REAL;
UPDATE teams SET team_HC=(SELECT SUM(FTAG) FROM allmatches WHERE HomeTeam=teams.team);
UPDATE teams SET team_AC=(SELECT SUM(FTHG) FROM allmatches WHERE AwayTeam=teams.team);
UPDATE allmatches SET team_HC=(SELECT team_HC FROM teams WHERE team =allmatches.HomeTeam);
UPDATE allmatches SET team_AC=(SELECT team_AC FROM teams WHERE team =allmatches.AwayTeam);
ALTER TABLE allmatches ADD COLUMN avg_HC DECIMAL(10,5);
ALTER TABLE allmatches ADD COLUMN avg_AC DECIMAL(10,5);
UPDATE allmatches SET avg_HC=(T_AG/GP);
UPDATE allmatches SET avg_AC=(T_HG/GP);
ALTER TABLE allmatches ADD COLUMN home_ds DECIMAL(10,5);
ALTER TABLE allmatches ADD COLUMN away_ds DECIMAL(10,5);
UPDATE allmatches SET home_ds = round(((team_HC/team_homeGP)/avg_HC),2);
UPDATE allmatches SET away_ds = round(((team_AC/team_awayGP)/avg_AC),2);
