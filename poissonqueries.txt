ALTER TABLE allmatches ADD COLUMN GP INTEGER;
ALTER TABLE allmatches ADD COLUMN T_HG INTEGER;
UPDATE leagues set GP=(SELECT COUNT(*) FROM allmatches WHERE division=leagues.d_vision);
UPDATE allmatches SET GP=(SELECT GP FROM leagues WHERE d_vision=allmatches.division);
UPDATE leagues SET T_HG=(SELECT SUM(FTHG) FROM allmatches WHERE division=leagues.d_vision);
UPDATE allmatches SET T_HG=(SELECT T_HG FROM leagues WHERE d_vision=allmatches.division);
ALTER TABLE allmatches ADD COLUMN avg_HG REAL;/* GP and T_HG need to start*/
UPDATE allmatches SET avg_HG=round(T_HG/GP,4);
ALTER TABLE allmatches ADD COLUMN T_AG integer;
UPDATE leagues SET T_AG=(SELECT SUM(FTAG) FROM allmatches WHERE division=leagues.d_vision);
UPDATE allmatches SET T_AG=(SELECT T_AG FROM leagues WHERE d_vision=allmatches.division);
ALTER TABLE allmatches ADD COLUMN avg_AG REAL;
UPDATE allmatches SET avg_AG=round(T_AG/GP,4); 
ALTER TABLE allmatches ADD COLUMN team_HG INTEGER;
ALTER TABLE allmatches ADD COLUMN team_homeGP INTEGER;
ALTER TABLE allmatches ADD COLUMN team_AG INTEGER;
ALTER TABLE allmatches ADD COLUMN team_awayGP INTEGER;
UPDATE teams SET team_HG=(SELECT SUM(FTHG) FROM allmatches WHERE HomeTeam=teams.team);
UPDATE teams SET team_homeGP=(SELECT COUNT(*) FROM allmatches WHERE HomeTeam=teams.team);
UPDATE teams SET team_AG=(SELECT SUM(FTAG) FROM allmatches WHERE AwayTeam=teams.team);
UPDATE teams SET team_awayGP=(SELECT COUNT(*) FROM allmatches WHERE AwayTeam=teams.team);
UPDATE allmatches SET team_HG=(SELECT team_HG FROM teams WHERE team =allmatches.HomeTeam);
UPDATE allmatches SET team_homeGP=(SELECT team_homeGP FROM teams WHERE team=allmatches.HomeTeam );
UPDATE allmatches SET team_AG=(SELECT team_AG FROM teams WHERE team=allmatches.AwayTeam);
UPDATE allmatches SET team_awayGP=(SELECT team_awayGP FROM teams WHERE team=allmatches.AwayTeam);
ALTER TABLE  allmatches ADD COLUMN home_as REAL;
ALTER TABLE  allmatches ADD COLUMN Away_as REAL;
UPDATE allmatches SET home_as = round(((team_HG/team_homeGP)/avg_HG),4);
UPDATE allmatches SET away_as = round(((team_AG/team_awayGP)/avg_HG),4);
ALTER TABLE allmatches add COLUMN team_HC INTEGER;
ALTER TABLE allmatches add  COLUMN team_AC INTEGER;
UPDATE teams SET team_HC=(SELECT SUM(FTAG) FROM allmatches WHERE HomeTeam=teams.team);
UPDATE teams SET team_AC=(SELECT SUM(FTHG) FROM allmatches WHERE AwayTeam=teams.team);
UPDATE allmatches SET team_HC=(SELECT team_HC FROM teams WHERE team =allmatches.HomeTeam);
UPDATE allmatches SET team_AC=(SELECT team_AC FROM teams WHERE team =allmatches.AwayTeam);
ALTER TABLE allmatches ADD COLUMN avg_HC REAL;
ALTER TABLE allmatches ADD COLUMN avg_AC REAL;
UPDATE allmatches SET avg_HC=round(T_AG/GP,4);
UPDATE allmatches SET avg_AC=round(T_HG/GP,4);
ALTER TABLE allmatches ADD COLUMN home_ds REAL;
ALTER TABLE allmatches ADD COLUMN away_ds REAL;
UPDATE allmatches SET home_ds = round(((team_HC/team_homeGP)/avg_HC),4);
UPDATE allmatches SET away_ds = round(((team_AC/team_awayGP)/avg_AC),4);
